(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["photo"],{2532:function(e,t,i){"use strict";var a=i("23e7"),n=i("5a34"),r=i("1d80"),s=i("ab13");a({target:"String",proto:!0,forced:!s("includes")},{includes:function(e){return!!~String(r(this)).indexOf(n(e),arguments.length>1?arguments[1]:void 0)}})},"44e7":function(e,t,i){var a=i("861d"),n=i("c6b6"),r=i("b622"),s=r("match");e.exports=function(e){var t;return a(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==n(e))}},"5a34":function(e,t,i){var a=i("44e7");e.exports=function(e){if(a(e))throw TypeError("The method doesn't accept regular expressions");return e}},"6ec5":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"photo"}},[[i("b-breadcrumb",[i("b-breadcrumb-item",{attrs:{to:"/Album"}},[i("i",{staticClass:"ni ni-folder-17"}),e._v(" Folder ")]),i("b-breadcrumb-item",{attrs:{active:""}},[i("i",{staticClass:"ni ni-image"}),e._v(" "+e._s(e.filename)+" ")]),i("div",{staticClass:"btns"},[i("base-button",{attrs:{type:"primary"},on:{click:e.addimg}},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:"./img/add_image.png",expression:"'./img/add_image.png'"}],staticClass:"rounded img-center img-fluid m-0"})])],1)],1)],i("Photoswipe",{staticClass:"row m-0 p-3 ps"},e._l(e.picture,(function(t,a){return i("div",{key:a,staticClass:"col-6 col-sm-4 col-md-4 col-lg-3 col-xl-2 card p-1",staticStyle:{display:"inline-block",height:"300px"}},[i("div",{staticClass:"col-12 p-0 card-content",staticStyle:{height:"100%"}},[i("div",{staticClass:"col-12 p-0",staticStyle:{height:"50%"}},[i("img",{directives:[{name:"pswp",rawName:"v-pswp",value:t,expression:"item"}],style:e.getImageItemStyle(t.src)})]),i("div",{staticClass:"card-body p-3",staticStyle:{height:"50%"}},[i("div",{staticClass:"txt-line-clamp2",staticStyle:{height:"50%"}},[t.edit?i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.model,expression:"item.model"}],staticClass:"form-control",attrs:{rows:"2",maxlength:"30"},domProps:{value:t.model},on:{input:function(i){i.target.composing||e.$set(t,"model",i.target.value)}}}):i("p",{staticClass:"card-text"},[e._v(e._s(t.title))])]),i("div",{staticClass:"row btns mt-2",staticStyle:{height:"50%"}},[t.edit?i("div",{staticClass:"col-6"},[i("base-button",{attrs:{type:"danger",icon:"fa fa-times"},on:{click:function(i){return e.cancel(t)}}})],1):i("div",{staticClass:"col-6"},[i("base-button",{attrs:{type:"success",icon:"fa fa-edit"},on:{click:function(i){return e.edit(t)}}})],1),t.edit?i("div",{staticClass:"col-6"},[i("base-button",{attrs:{type:"success",icon:"fa fa-check"},on:{click:function(i){return e.update(t,a)}}})],1):i("div",{staticClass:"col-6"},[i("base-button",{attrs:{type:"danger",icon:"fa fa-trash"},on:{click:function(i){return e.del(t,a)}}})],1)])])])])})),0),i("div",[i("b-modal",{attrs:{"no-fade":"","no-close-on-backdrop":"",centered:""},model:{value:e.addmodal,callback:function(t){e.addmodal=t},expression:"addmodal"}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-2 p-0 d-flex align-items-center justify-content-center"},[e._v("圖片：")]),i("div",{staticClass:"col-10"},[i("file-pond",{ref:"pond",attrs:{name:"add","label-idle":"選擇檔案或拖曳至此 (僅接受1MB以下的檔案)","allow-multiple":"true","max-files":"1",allowImageExifOrientation:"false",allowImagePreview:"true","accepted-file-types":"image/*","max-file-size":"1MB","label-max-file-size-exceeded":"檔案太大","label-max-file-size":"檔案不能超過{filesize}","label-file-processing":"上傳中","label-file-processing-complete":"上傳完成","label-tap-to-undo":"點擊刪除","label-tap-to-cancel":"點擊取消",server:e.myServer}})],1)]),i("div",{staticClass:"row"},[i("div",{staticClass:"col"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.description,expression:"description"}],staticClass:"form-control form-control-alternative",attrs:{placeholder:"相片說明 (30 字以下)",maxlength:"30"},domProps:{value:e.description},on:{input:function(t){t.target.composing||(e.description=t.target.value)}}})])]),i("div",{staticClass:"row warn mt-3"},[i("div",{staticClass:"swal2-validation-message",staticStyle:{display:"flex","margin-left":"-20px","margin-right":"-20px"},attrs:{id:"swal2-validation-message"}},[i("span",[e._v(e._s(e.warn))])])]),i("div",{staticClass:"row mt-3"},[i("div",{staticClass:"col-6 d-flex justify-content-end"},[i("b-button",{attrs:{id:"addbtn",variant:"primary"},on:{click:e.add}},[e._v("確定")])],1),i("div",{staticClass:"col-6 d-flex justify-content-start"},[i("b-button",{attrs:{id:"cancelbtn",variant:"cancel"},on:{click:e.cancelmodal}},[e._v("取消")])],1)])])],1)],2)},n=[],r=(i("a4d3"),i("e01a"),i("caad"),i("a434"),i("b0c0"),i("2532"),i("96cf"),i("1da1")),s={name:"photo",data:function(){var e=this;return{filename:this.$store.getters.file.name,addmodal:!1,file:"",myServer:{process:function(t,i,a,n){e.file=i;var r=document.getElementById("addbtn");r.disabled=!0,setTimeout((function(){n(Date.now()),r.disabled=!1}),1500)}},warn:"",picture:[],description:"",id:""}},computed:{user:function(){return this.$store.getters.user},fileinfo:function(){return this.$store.getters.file}},methods:{addimg:function(){var e=this;this.picture.length<5?this.addmodal=!this.addmodal:Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$swal.fire({icon:"warning",title:"相片最多只能 5 張",allowOutsideClick:!1,confirmButtonText:"確定"});case 2:case"end":return t.stop()}}),t)})))()},add:function(){var e=this,t=document.getElementsByClassName("filepond--assistant"),i=document.getElementsByClassName("warn"),a=document.getElementById("addbtn"),n=document.getElementById("cancelbtn"),s=new FormData;t[0].innerHTML.includes("檔案太大")?(i[0].hasAttribute("style","display: block")||i[0].setAttribute("style","display: block !important"),this.warn="檔案太大"):""===t[0].innerHTML?(i[0].hasAttribute("style","display: block")||i[0].setAttribute("style","display: block !important"),this.warn="未選擇檔案"):(t[0].innerHTML.includes("上傳完成")&&(s.append("image",this.file),a.disabled=!0,n.disabled=!0),s.append("description",this.description),s.append("filename",this.filename),this.axios.patch("https://vuephoto.herokuapp.com/file/"+this.id,s).then((function(t){a.disabled=!1,n.disabled=!1,e.picture.push({src:"https://vuephoto.herokuapp.com/file/"+t.data.result.name,title:t.data.result.description,edit:!1,model:""}),e.cancelmodal()})).catch((function(t){Object(r["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,e.$swal.fire({icon:"error",title:t.response.data.message,allowOutsideClick:!1,confirmButtonText:"確定"});case 2:case"end":return i.stop()}}),i)})))()})))},cancelmodal:function(){this.addmodal=!this.addmodal,this.description="",this.file=""},cancel:function(e){e.edit=!1,e.model=e.title},edit:function(e){e.edit=!0,e.model=e.title},del:function(e,t){var i=this;Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.$swal.fire({icon:"warning",title:"確定要刪除嗎？",allowOutsideClick:!1,showCancelButton:!0,cancelButtonText:"取消",confirmButtonText:"確定"}).then((function(e){if(e.isConfirmed){var a={do:"delimage",fileindex:i.fileinfo.index,imageindex:t};i.axios.patch("https://vuephoto.herokuapp.com/file/"+i.id,a).then((function(e){i.picture.splice(t,1)})).catch((function(){Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.$swal.fire({icon:"error",title:"發生錯誤",allowOutsideClick:!1,confirmButtonText:"確定"});case 2:case"end":return e.stop()}}),e)})))()}))}}));case 2:case"end":return e.stop()}}),e)})))()},update:function(e,t){var i=this,a={do:"editimage",fileindex:this.fileinfo.index,imageindex:t,description:e.model};this.axios.patch("https://vuephoto.herokuapp.com/file/"+this.id,a).then((function(t){e.edit=!1,e.title=e.model})).catch((function(){Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.$swal.fire({icon:"error",title:"發生錯誤",allowOutsideClick:!1,confirmButtonText:"確定"});case 2:case"end":return e.stop()}}),e)})))()}))},getImageItemStyle:function(e){return{width:"100%",height:"100%",backgroundImage:"url(".concat(e,")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}},getImg:function(){var e=this;this.axios.get("https://vuephoto.herokuapp.com/album/"+this.user).then((function(t){var i=t.data.result;e.id=i._id;for(var a=0;a<i.file.length;a++)if(i.file[a].name===e.filename)for(var n=0;n<i.file[a].image.length;n++)e.picture.push({src:"https://vuephoto.herokuapp.com/file/"+i.file[a].image[n].name,title:i.file[a].image[n].description,edit:!1,model:""});e.$store.commit("folder",e.checks)})).catch((function(){Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$swal.fire({icon:"error",title:"發生錯誤",allowOutsideClick:!1,confirmButtonText:"確定"});case 2:case"end":return t.stop()}}),t)})))()}))}},mounted:function(){this.getImg()}},o=s,c=i("2877"),l=Object(c["a"])(o,a,n,!1,null,null,null);t["default"]=l.exports},a434:function(e,t,i){"use strict";var a=i("23e7"),n=i("23cb"),r=i("a691"),s=i("50c4"),o=i("7b0b"),c=i("65f0"),l=i("8418"),d=i("1dde"),u=i("ae40"),m=d("splice"),p=u("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,h=Math.min,g=9007199254740991,v="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!m||!p},{splice:function(e,t){var i,a,d,u,m,p,b=o(this),w=s(b.length),x=n(e,w),y=arguments.length;if(0===y?i=a=0:1===y?(i=0,a=w-x):(i=y-2,a=h(f(r(t),0),w-x)),w+i-a>g)throw TypeError(v);for(d=c(b,a),u=0;u<a;u++)m=x+u,m in b&&l(d,u,b[m]);if(d.length=a,i<a){for(u=x;u<w-a;u++)m=u+a,p=u+i,m in b?b[p]=b[m]:delete b[p];for(u=w;u>w-a+i;u--)delete b[u-1]}else if(i>a)for(u=w-a;u>x;u--)m=u+a-1,p=u+i-1,m in b?b[p]=b[m]:delete b[p];for(u=0;u<i;u++)b[u+x]=arguments[u+2];return b.length=w-a+i,d}})},ab13:function(e,t,i){var a=i("b622"),n=a("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(i){try{return t[n]=!1,"/./"[e](t)}catch(a){}}return!1}},caad:function(e,t,i){"use strict";var a=i("23e7"),n=i("4d64").includes,r=i("44d2"),s=i("ae40"),o=s("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:!o},{includes:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),r("includes")}}]);
//# sourceMappingURL=photo.9ef25290.js.map